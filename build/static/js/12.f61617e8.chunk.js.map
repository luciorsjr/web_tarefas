{"version":3,"sources":["views/Documents.js"],"names":["Wall","api","useApi","useState","loading","setLoading","list","setList","showModal","setShowModal","modalLoading","setModalLoading","modalTitleField","setModalTitleField","modalFileField","setModalFileField","modalId","setModalId","useEffect","getList","getDocuments","result","error","handleCloseModal","handleRemoveButton","id","window","confirm","removeDocument","alert","handleModalSave","data","title","file","addDocument","updateDocument","color","onClick","name","items","fields","label","key","_style","width","noItemsViewSlot","hover","striped","bordered","pagination","itemsPerPage","scopedSlots","actions","item","index","findIndex","v","open","handleDownloadButton","handleEditButton","show","onClose","closeButton","htmlFor","type","placeholder","value","onChange","e","target","disabled","files"],"mappings":"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","file":"static/js/12.f61617e8.chunk.js","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport {\n  CRow,\n  CCol,\n  CCard,\n  CCardHeader,\n  CButton,\n  CCardBody,\n  CDataTable,\n  CButtonGroup,\n  CModal,\n  CModalHeader,\n  CModalBody,\n  CModalFooter,\n  CFormGroup,\n  CLabel,\n  CInput,\n} from \"@coreui/react\";\nimport CIcon from \"@coreui/icons-react\";\nimport useApi from \"../services/api\";\n\nexport default function Wall() {\n  const api = useApi();\n\n  const [loading, setLoading] = useState(true);\n  const [list, setList] = useState([]);\n  const [showModal, setShowModal] = useState(false);\n  const [modalLoading, setModalLoading] = useState(false);\n  const [modalTitleField, setModalTitleField] = useState(\"\");\n  const [modalFileField, setModalFileField] = useState(\"\");\n  const [modalId, setModalId] = useState(\"\");\n\n  const fields = [\n    { label: \"Título\", key: \"title\" },\n    { label: \"Ações\", key: \"actions\", _style: { width: \"1px\" } },\n  ];\n\n  useEffect(() => {\n    getList();\n  }, []);\n\n  const getList = async () => {\n    setLoading(true);\n    const result = await api.getDocuments();\n    setLoading(false);\n    if (result.error === \"\") {\n      setList(result.list);\n    } else {\n      setList(result.error);\n    }\n  };\n\n  const handleCloseModal = () => {\n    setShowModal(false);\n  };\n\n  const handleEditButton = (id) => {\n    let index = list.findIndex(v=>v.id===id)\n    setModalId(list[index][\"id\"]);\n    setModalTitleField(list[index][\"title\"]);\n    // setModalBodyField(list[index][\"body\"]);\n    setShowModal(true);\n  };\n\n  const handleRemoveButton = async (id) => {\n    if (window.confirm(\"Tem certeza que deseja excluir?\")) {\n      const result = await api.removeDocument(id);\n      if (result.error === \"\") {\n        getList();\n      } else {\n        alert(result.error);\n      }\n    }\n  };\n\n  const handleNewButton = () => {\n    setModalId(\"\");\n    setModalTitleField(\"\");\n    setModalFileField(\"\");\n    setShowModal(true);\n  };\n\n  const handleModalSave = async () => {\n    if (modalTitleField) {\n      setModalLoading(true);\n      let result;\n      let data = {\n        title: modalTitleField,\n      };\n\n      if (modalId === \"\") {\n        if(modalFileField) {\n          data.file = modalFileField\n          result = await api.addDocument(data);\n        } else {\n          alert(\"Selecione o arquivo!\")\n          setModalLoading(false)\n          return\n        }\n      } else {\n        if(modalFileField) {\n          data.file = modalFileField\n        }\n        result = await api.updateDocument(modalId, data);\n      }\n\n      setModalLoading(false);\n      if (result.error === \"\") {\n        setShowModal(false);\n        getList();\n      } else {\n        alert(result.error);\n      }\n    } else {\n      alert(\"Preencha os campos!\");\n    }\n  };\n\n  const handleDownloadButton = (id) => {\n    let index = list.findIndex(v=>v.id===id)\n    window.open(list[index]['fileurl'])\n  }\n\n  return (\n    <>\n      <CRow>\n        <CCol>\n          <h2>Documentos</h2>\n          <CCard>\n            <CCardHeader>\n              <CButton color=\"primary\" onClick={handleNewButton}>\n                <CIcon name=\"cil-check\" />\n                Novo Documento\n              </CButton>\n            </CCardHeader>\n            <CCardBody>\n              <CDataTable\n                items={list}\n                fields={fields}\n                loading={loading}\n                noItemsViewSlot=\" \"\n                hover\n                striped\n                bordered\n                pagination\n                itemsPerPage={5}\n                scopedSlots={{\n                  actions: (item, index) => (\n                    <td>\n                      <CButtonGroup>\n                      <CButton\n                          color=\"success\"\n                          onClick={() => handleDownloadButton(item.id)}\n                        >\n                          <CIcon name=\"cil-cloud-download\"/>\n                        </CButton>\n                        <CButton\n                          color=\"info\"\n                          onClick={() => handleEditButton(item.id)}\n                        >\n                          Editar\n                        </CButton>\n                        <CButton\n                          color=\"danger\"\n                          onClick={() => handleRemoveButton(item.id)}\n                        >\n                          Excluir\n                        </CButton>\n                      </CButtonGroup>\n                    </td>\n                  ),\n                }}\n              />\n            </CCardBody>\n          </CCard>\n        </CCol>\n      </CRow>\n\n      <CModal show={showModal} onClose={handleCloseModal}>\n        <CModalHeader closeButton>\n          {modalId === \"\" ? \"Novo\" : \"Editar\"} Documento\n        </CModalHeader>\n        <CModalBody>\n\n          <CFormGroup>\n            <CLabel htmlFor=\"modal-title\">Titulo do Documento</CLabel>\n            <CInput\n              type=\"text\"\n              id=\"modal-title\"\n              placeholder=\"Digite um título para o documento\"\n              value={modalTitleField}\n              onChange={(e) => setModalTitleField(e.target.value)}\n              disabled={modalLoading}\n            />\n          </CFormGroup>\n\n          <CFormGroup>\n            <CLabel htmlFor=\"modal-file\">Arquivo (pdf)</CLabel>\n            <CInput\n              type=\"file\"\n              id=\"modal-file\"\n              name=\"file\"\n              placeholder=\"Escolha um arquivo\"\n              onChange={e=>setModalFileField(e.target.files[0])}\n            />\n          </CFormGroup>\n\n        </CModalBody>\n        <CModalFooter>\n          <CButton\n            color=\"primary\"\n            onClick={handleModalSave}\n            disabled={modalLoading}\n          >\n            {modalLoading ? \"Carregando...\" : \"Salvar\"}\n          </CButton>\n          <CButton\n            color=\"secondary\"\n            onClick={handleCloseModal}\n            disabled={modalLoading}\n          >\n            {modalLoading ? \"Carregando...\" : \"Cancelar\"}\n          </CButton>\n        </CModalFooter>\n      </CModal>\n    </>\n  );\n}\n"],"sourceRoot":""}